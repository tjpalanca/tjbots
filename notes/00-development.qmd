---
title: Development
subtitle: "Miscellaneous development notes" 
---

## Development

### Creating the dev container

[Devcontainer specification](../.devcontainer/devcontainer.json)

* Used microsoft's base dev container and some devcontainer features to enable `python` with `uv`, `nodejs`, and `quarto`. This creates a minimal setup for developing Shiny for Python applications.
* Mounting the `uv` cache as a separate volume speeds up future re-creations of the devcontainer and installation of previously-installed dependencies.

### Pre-building the dev container 

* Added a github action to build the devcontainer and publish it for the following purposes:
    - To make future devcontainer builds faster
    - To use the devcontainer for executing CI actions consistent with the local development experience

```yaml 
    - name: Pre-build dev container image
      uses: devcontainers/ci@v0.3
      with:
        imageName: ghcr.io/tjpalanca/tjbots/devcontainer
        cacheFrom: ghcr.io/tjpalanca/tjbots/devcontainer
        push: always
``` 

### Keybindings 

These are to help with rapid development.

```jsonc 
{
    "key": "shift+cmd+enter",
    "command": "shiny.python.runApp",
    "when": "shellExecutionSupported && editorLangId == 'python'"
}
```

## Troubleshooting

### Activating auto-reload

* Initially, the auto-reload feature did not work well in the devcontainer setup either in VS Code or in Positron.
* We needed to set `remote.autoForwardPortsSource` to `process` and disable the fallback by setting `remote.autoForwardPortsFallback` to `0`, which creates a bunch of spurious ones but also surfaced the autoreload port.
    * Setting `remote.restoreForwardedPorts` to `false` alleviated it by forgetting every time the devcontainer is started.
* It still does not work well enough, we need to run the app twice, but at least it's good.

### Format on save for quarto documents

* I would like `quarto` to format my markdown in addition to the code blocks.
* I couldn't find a clean way to do this, unfortunately. 